## ExchangeRateMonitor
_REST API для мониторинга изменений курса валют_

## Описание
Интерфейс обращается к сервису курсов валют.                                                                           
Результатом обращения является анимация в формате gif.                                                                 
Если курс выбранной валюты по сравнению со вчерашним днём изменился в большую сторону, из пула анимаций по тегу **Rich** 
выбирается случайная и выводится на экран. Если курс изменился в меньшую сторону - анимация выбирается по тегу **Broke**.     

Анализ разницы курсов осуществляется в двух вариантах:
* на основе отношения курса выбранной валюты к курсу USD (по умолчанию)
* на основе отношения курса выбранной валюты к курсу RUB

Сервис курса валют: https://openexchangerates.org/                                                                     
Сервис, предоставляющий анимации: https://giphy.com

## Запуск

Для локального тестирования (требуется JRE 11 и Gradle в системной переменной Path):
1. Клонируйте репозиторий
2. В папке проекта запустите в терминале StartERMA.bat
3. Сервер доступен по адресу http://localhost:8100

Конфигурационный файл расположен по пути src\main\resources\application.properties.                                    
С его помощью можно настроить:
* порт подключения к серверу
* основные пути обращения к сервисам курсов валют и анимаций
* пользовательские id для корректной работы с сервисами
* валюту, на основе которой производятся расчёты (при бесплатном использовании сервиса курсов валют, 
значение должно быть "USD")
* количество дней (n), для оценки изменения курса с момента (сегодня - n) по сегодняшний день  
* теги для поиска анимаций
* рейтинг искомых анимаций ([g, pg, pg-13, r](https://developers.giphy.com/docs/optional-settings#rating))
* анимацию, возвращаемую в случае отсутствия изменений в курсе валюты 

## Конечные точки и примеры запросов
**/{currencyCode}**                                                                                                    
Вместо переменной пути "currencyCode" указывается трёхсимвольный код валюты, изменение курса которой нужно оценить.    
[Список поддерживаемых валют](https://docs.openexchangerates.org/docs/supported-currencies)
                                                           

Примеры:                                                                                                               
http://localhost:8100/RUB                                                                                              
Отображает анимацию, выбранную в зависимости от разницы между вчерашней и сегодняшней ценами рубля за один доллар.

http://localhost:8100/EUR                                                                                              
Отображает анимацию, выбранную в зависимости от разницы между вчерашней и сегодняшней ценами евро за один доллар.

http://localhost:8100/USD                                                                                              
Отображает анимацию, выбранную в зависимости от разницы между вчерашней и сегодняшней ценами доллара за один доллар.   
Такой запрос всегда будет возвращать "отсутствие изменений".                                                             

________________________________________

**/{currencyCode}?basedOn=RUB**                                                                                        
Добавление параметра запроса позволяет изменить логику анализа таким образом, чтобы оценивалось изменение курсов по 
отношению к рублю.                                                                                                     
Никакая другая валюта кроме рубля не поддерживается в качестве основы для расчётов. Для изменения основы расчётов 
требуется оформить соответствующую [подписку](https://openexchangerates.org/account/subscription).

Примеры:                                                                                                               
http://localhost:8100/RUB?basedOn=RUB                                                                                  
Отображает анимацию, выбранную в зависимости от разницы между вчерашней и сегодняшней ценами рубля за один рубль.
Такой запрос всегда будет возвращать "отсутствие изменений".                                                           

http://localhost:8100/EUR?basedOn=RUB                                                                                  
Отображает анимацию, выбранную в зависимости от разницы между вчерашней и сегодняшней ценами евро за один рубль.

http://localhost:8100/USD?basedOn=RUB                                                                                  
Отображает анимацию, выбранную в зависимости от разницы между вчерашней и сегодняшней ценами доллара за один рубль.   

## Задействованные технологии
Spring Boot 2                                                                                                          
OpenFeign                                                                                                              
JUnit + Mockito                                                                                                        
Gradle                                                                                                                 